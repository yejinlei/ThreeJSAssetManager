<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThreeJSAssetsManageræ¡†æ¶æµ‹è¯•é¡µ</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #000;
            overflow: hidden;
        }

        #canvas01 {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            outline: none;
        }

        .info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: #00ff88;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            border: 1px solid #00ff88;
        }

        .info h3 {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .info p {
            margin: 5px 0;
            font-size: 12px;
            color: #fff;
        }

        .info code {
            background: rgba(0, 255, 136, 0.2);
            padding: 2px 6px;
            border-radius: 3px;
            color: #00ff88;
        }
    </style>

    <!-- æ·»åŠ  Import Maps é…ç½® -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://gcore.jsdelivr.net/npm/three@0.179.1/build/three.module.js",
            "three/addons/": "https://gcore.jsdelivr.net/npm/three@0.179.1/examples/jsm/",
            "lil-gui": "https://gcore.jsdelivr.net/npm/lil-gui@0.18.1/dist/lil-gui.esm.min.js"
        }
    }
    </script>

    <!-- Cannon.js for Physics -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://gcore.jsdelivr.net/npm/three@0.179.1/build/three.module.js",
            "three/addons/": "https://gcore.jsdelivr.net/npm/three@0.179.1/examples/jsm/",
            "lil-gui": "https://gcore.jsdelivr.net/npm/lil-gui@0.18.1/dist/lil-gui.esm.min.js",
            "cannon-es": "https://cdn.jsdelivr.net/npm/cannon-es@0.20.0/dist/cannon-es.js"
        }
    }
    </script>
</head>

<body>
    <canvas id="canvas01"></canvas>

    <div class="info">
        <h3>ğŸ® ThreeJSAssetsManager æµ‹è¯•</h3>
        <p>âœ… DebugUI å·²å¯ç”¨</p>
        <p>ğŸ’¡ ä½¿ç”¨å³ä¾§é¢æ¿è°ƒæ•´å‚æ•°</p>
        <p>ğŸ”§ URL: <code>test.html#debug</code></p>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import ThreeJSAssetsManager from './ThreeJSAssetsManager/ThreeJSAssetsManager.js';
        import config from './ThreeJSAssetsManager/config.js';

        // æ£€æµ‹ URL ä¸­çš„ #debug æ ‡å¿—ï¼Œå¼ºåˆ¶å¯ç”¨ DebugUI
        if (window.location.hash === '#debug') {
            config.DebugUI.enabled = true;
            console.log('âœ… DebugUI enabled via URL hash');
        }

        // å¯ç”¨ä¸€äº›åŠŸèƒ½ç”¨äºæµ‹è¯•
        config.Helpers.grid.enabled = true;
        config.Helpers.axes.enabled = true;
        config.PostProcessing.enabled = false; // å¯é€šè¿‡ DebugUI å¯ç”¨
        config.Interaction.enabled = true;

        // åˆå§‹åŒ–
        const canvas = document.getElementById('canvas01');
        const manager = new ThreeJSAssetsManager(canvas);

        // å…¨å±€è®¿é—®
        window.manager = manager;
        window.THREE = THREE;

        console.log('ğŸš€ ThreeJSAssetsManager initialized');
        console.log('ğŸ“¦ Available managers:', {
            postProcessor: !!manager.postProcessor,
            helperManager: !!manager.helperManager,
            interactionManager: !!manager.interactionManager,
            particleManager: !!manager.particleManager,
            performanceManager: !!manager.performanceManager,
            shaderManager: !!manager.shaderManager,
            physicsManager: !!manager.physicsManager,
            audioManager: !!manager.audioManager,
            webXRManager: !!manager.webXRManager
        });

        // æ·»åŠ ä¸€äº›æµ‹è¯•å¯¹è±¡
        setTimeout(() => {
            // æ·»åŠ åœ°é¢
            const groundGeometry = new THREE.PlaneGeometry(10, 10);
            const groundMaterial = new THREE.MeshStandardMaterial({
                color: 0x333333,
                metalness: 0.1,
                roughness: 0.9
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            ground.name = 'Ground';
            manager.scene.add(ground);

            console.log('âœ… Test objects added to scene');
        }, 100);

        // äº¤äº’å›è°ƒ
        if (manager.interactionManager) {
            manager.interactionManager.onClickEvent((object, intersection) => {
                console.log('ğŸ–±ï¸ Clicked:', object.name || object.type);
                if (object.material && object.material.color) {
                    object.material.color.setHex(Math.random() * 0xffffff);
                }
            });

            manager.interactionManager.onHover((object, intersection) => {
                console.log('ğŸ‘† Hovering:', object.name || object.type);
            });
        }
    </script>
</body>

</html>